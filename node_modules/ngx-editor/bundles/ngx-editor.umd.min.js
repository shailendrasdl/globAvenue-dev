!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core"),require("@angular/forms"),require("prosemirror-state"),require("prosemirror-view"),require("prosemirror-commands"),require("prosemirror-schema-list"),require("prosemirror-model"),require("prosemirror-schema-basic")):"function"==typeof define&&define.amd?define("ngx-editor",["exports","@angular/core","@angular/forms","prosemirror-state","prosemirror-view","prosemirror-commands","prosemirror-schema-list","prosemirror-model","prosemirror-schema-basic"],t):t((e=e||self)["ngx-editor"]={},e.ng.core,e.ng.forms,e.prosemirrorState,e.prosemirrorView,e.prosemirrorCommands,e.prosemirrorSchemaList,e.prosemirrorModel,e.prosemirrorSchemaBasic)}(this,(function(e,t,o,r,n,i,d,s,a){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation.

    Permission to use, copy, modify, and/or distribute this software for any
    purpose with or without fee is hereby granted.

    THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
    REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
    AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
    INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
    LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
    OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
    PERFORMANCE OF THIS SOFTWARE.
    ***************************************************************************** */function c(e,t,o,r){var n,i=arguments.length,d=i<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,o):r;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)d=Reflect.decorate(e,t,o,r);else for(var s=e.length-1;s>=0;s--)(n=e[s])&&(d=(i<3?n(d):i>3?n(t,o,d):n(t,o))||d);return i>3&&d&&Object.defineProperty(t,o,d),d}var l=function(e,t){var o=e.selection,r=o.from,n=o.$from,i=o.to;return o.empty?!!t.isInSet(e.storedMarks||n.marks()):e.doc.rangeHasMark(r,i,t)},p=function(e,t){for(var o=t.depth;o>0;o--)if(t.node(o).type===e)return t.node(o).type;return null},u=p,h=function(e,t,o){void 0===o&&(o={});var r=e.selection,n=r.$from,i=r.to,d=p(t,n);return Object.entries(o).length&&d?i<=n.end()&&n.parent.hasMarkup(t,o):!!d},m=function(e,t){return e===t.nodes.list_item||e===t.nodes.ordered_list||e===t.nodes.bullet_list},g=function(e,t,o){return void 0===o&&(o={}),function(r,n){return h(r,e,o)?i.setBlockType(t)(r,n):i.setBlockType(e,o)(r,n)}},f=function(e,t){return function(o,r){return h(o,e)?d.liftListItem(t)(o,r):d.wrapInList(e)(o,r)}},_=function(e){return function(t,o){return h(t,e)?i.lift(t,o):i.wrapIn(e)(t,o)}},v={bold:'\n  <path d="M15.6 10.79c.97-.67 1.65-1.77 1.65-2.79 0-2.26-1.75-4-4-4H7v14h7.04c2.09 0 3.71-1.7 3.71-3.79 0-1.52-.86-2.82-2.15-3.42zM10 6.5h3c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5h-3v-3zm3.5 9H10v-3h3.5c.83 0 1.5.67 1.5 1.5s-.67 1.5-1.5 1.5z" />\n  <path d="M0 0h24v24H0z" fill="none" />\n',italic:'\n  <path d="M0 0h24v24H0z" fill="none" />\n  <path d="M10 4v3h2.21l-3.42 8H6v3h8v-3h-2.21l3.42-8H18V4z" />\n',code:'\n<path d="M0 0h24v24H0V0z" fill="none"/>\n<path d="M9.4 16.6L4.8 12l4.6-4.6L8 6l-6 6 6 6 1.4-1.4zm5.2 0l4.6-4.6-4.6-4.6L16 6l6 6-6 6-1.4-1.4z"/>\n',ordered_list:'\n<path d="M2 17h2v.5H3v1h1v.5H2v1h3v-4H2v1zm1-9h1V4H2v1h1v3zm-1 3h1.8L2 13.1v.9h3v-1H3.2L5 10.9V10H2v1zm5-6v2h14V5H7zm0 14h14v-2H7v2zm0-6h14v-2H7v2z"/>\n<path d="M0 0h24v24H0z" fill="none"/>\n',bullet_list:'\n<path d="M0 0h24v24H0V0z" fill="none"/>\n<path d="M4 10.5c-.83 0-1.5.67-1.5 1.5s.67 1.5 1.5 1.5 1.5-.67 1.5-1.5-.67-1.5-1.5-1.5zm0-6c-.83 0-1.5.67-1.5 1.5S3.17 7.5 4 7.5 5.5 6.83 5.5 6 4.83 4.5 4 4.5zm0 12c-.83 0-1.5.68-1.5 1.5s.68 1.5 1.5 1.5 1.5-.68 1.5-1.5-.67-1.5-1.5-1.5zM7 19h14v-2H7v2zm0-6h14v-2H7v2zm0-8v2h14V5H7z"/>\n',quote:'\n<path d="M0 0h24v24H0z" fill="none"/><path d="M6 17h3l2-4V7H5v6h3zm8 0h3l2-4V7h-6v6h3z"/>\n'};var w=function(e,t){return void 0===t&&(t=1),t>0?e.reduce((function(e,o){return e.concat(Array.isArray(o)?w(o,t-1):o)}),[]):e.slice()},x={bold:{key:"strong",i18nKey:"bold",icon:"bold",type:"mark"},italic:{key:"em",i18nKey:"italics",icon:"italic",type:"mark"},code:{key:"code",i18nKey:"code",icon:"code",type:"mark"},ordered_list:{key:"ordered_list",i18nKey:"ordered_list",icon:"ordered_list",type:"node"},bullet_list:{key:"bullet_list",i18nKey:"bullet_list",icon:"bullet_list",type:"node"},h1:{key:"heading",i18nKey:"heading",attrs:{level:1},type:"node"},h2:{key:"heading",i18nKey:"heading",attrs:{level:2},type:"node"},h3:{key:"heading",i18nKey:"heading",attrs:{level:3},type:"node"},h4:{key:"heading",i18nKey:"heading",attrs:{level:4},type:"node"},h5:{key:"heading",i18nKey:"heading",attrs:{level:5},type:"node"},h6:{key:"heading",i18nKey:"heading",attrs:{level:6},type:"node"},blockquote:{key:"blockquote",i18nKey:"blockquote",icon:"quote",type:"node"}},y=new Map;y.set("heading",["h1","h2","h3","h4","h5","h6"]);var E=function(){function e(e,t,o,r){this.updates=[],this.dropdownGroup=e,this.dropdownFields=t,this.editorView=o,this.options=r}return e.prototype.getWrapperDom=function(){var e=this,t=!1,o=document.createElement("div"),r=this.options.labels;o.classList.add("NgxEditor__Dropdown");var n=document.createElement("div");n.classList.add("NgxEditor__Dropdown__Text"),n.textContent=r[this.dropdownGroup],o.appendChild(n);var i=document.createElement("div");i.classList.add("NgxEditor__Dropdown__DropdownMenu");var d=function(e){e.preventDefault(),o.contains(e.target)||s()},s=function(){o.classList.remove("NgxEditor__Dropdown--Open"),t=!1,window.removeEventListener("mousedown",d)};return o.addEventListener("click",(function(e){e.preventDefault(),t?s():function(e){var r=e.target;i.contains(r)||(o.classList.add("NgxEditor__Dropdown--Open"),t=!0,window.addEventListener("mousedown",d))}(e)})),this.dropdownFields.forEach((function(t){var d=x[t],a=r[d.key];"heading"===d.key&&(a+=" "+d.attrs.level);var c={classNames:["NgxEditor__Dropdown__Item"],textContent:a,attrs:{title:a},activeClass:"NgxEditor__Dropdown--Active",disabledClass:"NgxEditor--Disabled"},l=new b(d,e.editorView,c).render(),p=l.update,u=l.dom;u.addEventListener("click",(function(e){e.preventDefault(),s()}));i.appendChild(u),e.updates.push((function(t){p(t);var d=i.getElementsByClassName("NgxEditor__Dropdown--Active");if(d.length){var s=d[0];n.textContent=s.textContent,o.classList.add("NgxEditor__Dropdown--Selected")}else n.textContent=r[e.dropdownGroup],o.classList.remove("NgxEditor__Dropdown--Selected")}))})),o.appendChild(i),o},e.prototype.render=function(){return this.dom=this.getWrapperDom(),{dom:this.dom,updates:this.updates}},e}(),b=function(){function e(e,t,o){this.menuItem=e,this.editorView=t,this.spec=o}return e.prototype.render=function(){var e=this,t=this.dom=this.getDom(),o=this.editorView.state.schema,r=this.setupCommandListeners().command,n=this.spec,i=n.activeClass,d=n.disabledClass;return{dom:t,update:function(n){var s=e.menuItem,a=!1,c=r(e.editorView.state,null);if("mark"===s.type){var p=o.marks[s.key];a=l(n,p)}if("node"===s.type){p=o.nodes[s.key];a=h(n,p,s.attrs)}t.classList.toggle(i,a),t.classList.toggle(d,!c)}}},e.prototype.getDom=function(){var e=document.createElement("div");return this.spec.classNames&&this.spec.classNames.forEach((function(t){e.classList.add(t)})),this.spec.attrs&&Object.entries(this.spec.attrs).forEach((function(t){e.setAttribute(t[0],t[1])})),this.spec.innerHTML&&(e.innerHTML=this.spec.innerHTML),this.spec.textContent&&(e.innerHTML=this.spec.textContent),e},e.prototype.setupCommandListeners=function(){var e,t=this,o=this.editorView.state.schema;if("mark"===this.menuItem.type&&(e=i.toggleMark(o.marks[this.menuItem.key])),"node"===this.menuItem.type){var r=o.nodes[this.menuItem.key];m(r,o)&&(e=f(r,o.nodes.list_item)),r===o.nodes.heading&&(e=g(r,o.nodes.paragraph,{level:this.menuItem.attrs.level})),r===o.nodes.blockquote&&(e=_(r))}return this.dom.addEventListener("mousedown",(function(o){o.preventDefault(),1===o.buttons&&e(t.editorView.state,t.editorView.dispatch)})),{command:e}},e}(),N=function(){var e=document.createElement("div");return e.className="NgxEditor__Seperator",e},k=function(){function e(e,t){this.view=e,this.options=t,this.render(),this.update()}return e.prototype.render=function(){var e=document.createElement("div");e.className="NgxEditor__MenuBar";var t=function(e,t,o){var r=[],n=e.toolbar;n.forEach((function(i,d){var s=n.length-1===d;i.forEach((function(n,d){var a,c,l,p=i.length-1===d;if("object"==typeof n&&Object.keys(n).forEach((function(i){if(y.has(i)){var d=n[i],s=new E(i,d,t,e).render();r.push(s.updates),o.appendChild(s.dom)}else console.warn("Unkown dropdown group:",i)})),"string"==typeof n){var u=x[n],h=e.labels;if(u){var m={classNames:["NgxEditor__MenuItem","NgxEditor__MenuItem--Icon"],innerHTML:(a=u.icon,void 0===c&&(c=20),void 0===l&&(l=20),'\n  <svg\n    xmlns="http://www.w3.org/2000/svg"\n    viewBox="0 0 24 24"\n    fill="black"\n    height='+l+"\n    width="+c+"\n  >\n    "+(v[a]||"<path></path>")+"\n  </svg>\n  "),attrs:{title:h[u.i18nKey]},activeClass:"NgxEditor__MenuItem--Active",disabledClass:"NgxEditor--Disabled"},g=new b(u,t,m).render(),f=g.update,_=g.dom;o.appendChild(_),r.push(f)}}if("function"==typeof n){var w=n(t);_=w.dom,f=w.update;o.appendChild(_),r.push(f)}if(p&&!s){var k=N();o.appendChild(k)}}))}));var i=w(r,1/0);return{update:function(e){i.forEach((function(t){t(e)}))}}}(this.options,this.view,e).update;this.updateMenuItems=t,this.view.dom.parentNode.insertBefore(e,this.view.dom)},e.prototype.update=function(){this.updateMenuItems(this.view.state)},e}(),D={toolbar:[["bold","italic"],["code","blockquote"],["ordered_list","bullet_list"],[{heading:["h1","h2","h3","h4","h5","h6"]}]],labels:{bold:"Bold",italics:"Italics",code:"Code",ordered_list:"Ordered List",bullet_list:"Bullet List",heading:"Heading",blockquote:"Quote"}};var M=function(e){return void 0===e&&(e=D),function(e){return new r.Plugin({key:new r.PluginKey("menu"),view:function(t){return new k(t,e)}})}(e)};function I(e){return void 0===e&&(e="Type Here..."),new r.Plugin({key:new r.PluginKey("placeholder"),props:{decorations:function(t){var o=t.doc;if(1===o.childCount&&o.firstChild.isTextblock&&0===o.firstChild.content.size){var r=document.createElement("span");return r.classList.add("NgxEditor__Placeholder"),r.textContent=e,n.DecorationSet.create(o,[n.Decoration.widget(1,r)])}return n.DecorationSet.empty}}})}var C=Object.assign({},d.listItem,{content:"paragraph block*"}),L=Object.assign({},d.orderedList,{content:"list_item+",group:"block"}),z=Object.assign({},d.bulletList,{content:"list_item+",group:"block"}),H=Object.assign({},a.nodes,{list_item:C,ordered_list:L,bullet_list:z}),V=a.marks,O=new s.Schema({marks:V,nodes:H}),T=function(){function e(){this.plugins=[M(),I()],this.nodeViews={},this.schema=O}return e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e=c([t.Injectable({providedIn:"root"})],e)}(),j=function(){function e(e){this.config=e}var o,r;return e.ctorParameters=function(){return[{type:T,decorators:[{type:t.Optional}]}]},e.ɵprov=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(T,8))},token:e,providedIn:"root"}),e=c([t.Injectable({providedIn:"root"}),(o=0,r=t.Optional(),function(e,t){r(e,t,o)})],e)}(),S={plugins:[],nodeViews:{},schema:O};function q(e){return Object.assign({},S,e)}var K=function(){function e(e){this.editorInitialized=!1,this.config=e.config}var i;return i=e,e.prototype.writeValue=function(e){this.editorInitialized&&this.updateContent(e)},e.prototype.registerOnChange=function(e){this.onChange=e},e.prototype.registerOnTouched=function(){},e.prototype.parseDoc=function(e){return e?this.config.schema.nodeFromJSON(e):null},e.prototype.updateContent=function(e){try{var t=this.parseDoc(e),o=this.view.state;if(null!==t&&o.doc.eq(t))return;var r=o.tr;r.replaceWith(0,o.doc.content.size,t),this.view.dispatch(r)}catch(e){console.error("Unable to update document.",e)}},e.prototype.handleTransactions=function(e){var t=this.view.state.applyTransaction(e).state;if(this.view.updateState(t),e.docChanged&&this.onChange){var o=t.doc.toJSON();this.onChange(o)}},e.prototype.createEditor=function(){var e=this.config,t=e.schema,o=e.plugins,i=e.nodeViews;this.view=new n.EditorView(this.ngxEditor.nativeElement,{state:r.EditorState.create({schema:t,plugins:o}),nodeViews:i,dispatchTransaction:this.handleTransactions.bind(this),attributes:{class:"NgxEditor__Content"}}),this.editorInitialized=!0},e.prototype.ngOnInit=function(){this.createEditor()},e.prototype.ngOnDestroy=function(){this.view.destroy()},e.ctorParameters=function(){return[{type:j}]},c([t.ViewChild("ngxEditor",{static:!0})],e.prototype,"ngxEditor",void 0),e=i=c([t.Component({selector:"ngx-editor",template:'<div class="NgxEditor" #ngxEditor></div>\n',providers:[{provide:o.NG_VALUE_ACCESSOR,useExisting:t.forwardRef((function(){return i})),multi:!0}],encapsulation:t.ViewEncapsulation.None,styles:['.NgxEditor{background:padding-box #fff;color:#000;border-radius:4px;border:2px solid rgba(0,0,0,.2)}.NgxEditor__MenuBar{display:flex;padding:.2rem;border-bottom:1px solid #ddd;cursor:default;height:1.85rem}.NgxEditor__MenuItem{border-radius:2px;display:flex;align-items:center;justify-content:center}.NgxEditor__MenuItem:hover{background-color:#f1f1f1}.NgxEditor__MenuItem.NgxEditor__MenuItem--Icon{height:1.85rem;width:1.85rem;transition:.3s ease-in-out;margin-right:2px}.NgxEditor__MenuItem.NgxEditor__MenuItem--Text{padding:0 .3rem}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active{background-color:#e8f0fe;color:#1a73e8}.NgxEditor__MenuItem.NgxEditor__MenuItem--Active svg{fill:#1a73e8}.NgxEditor--Disabled{opacity:.5;pointer-events:none}.NgxEditor__Seperator{border-left:1px solid #ccc;margin:0 .3rem}.NgxEditor__Dropdown{min-width:4rem;position:relative;display:flex;align-items:center}.NgxEditor__Dropdown:hover{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown__Text{display:flex;align-items:center;padding:0 .3rem}.NgxEditor__Dropdown .NgxEditor__Dropdown__Text::after{display:inline-block;content:"";margin-left:1.5rem;vertical-align:.25rem;border-top:.25rem solid;border-right:.25rem solid transparent;border-bottom:0;border-left:.25rem solid transparent}.NgxEditor__Dropdown .NgxEditor__Dropdown__DropdownMenu{position:absolute;left:0;top:calc(1.85rem + 2px);box-shadow:rgba(60,64,67,.15) 0 2px 6px 2px;border-radius:4px;background-color:#fff;display:none;z-index:10;width:100%}.NgxEditor__Dropdown .NgxEditor__Dropdown__Item{padding:.5rem;white-space:nowrap;color:inherit}.NgxEditor__Dropdown .NgxEditor__Dropdown__Item:hover{background-color:#ececec}.NgxEditor__Dropdown.NgxEditor__Dropdown--Open,.NgxEditor__Dropdown.NgxEditor__Dropdown--Selected{background-color:#e8f0fe}.NgxEditor__Dropdown.NgxEditor__Dropdown--Open .NgxEditor__Dropdown__Text,.NgxEditor__Dropdown.NgxEditor__Dropdown--Selected .NgxEditor__Dropdown__Text{color:#1a73e8}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active{background-color:#f1f1f1}.NgxEditor__Dropdown .NgxEditor__Dropdown--Active:hover{background-color:#e7e7e7}.NgxEditor__Dropdown.NgxEditor__Dropdown--Open .NgxEditor__Dropdown__DropdownMenu{display:block}.NgxEditor__Placeholder{color:#6c757d;opacity:1}.NgxEditor__Content{padding:.5rem;white-space:pre-wrap}.NgxEditor__Content p{margin:0 0 .7rem}.NgxEditor__Content blockquote{padding-left:1rem;border-left:3px solid #ddd;margin-left:0;margin-right:0}.ProseMirror{outline:0}']})],e)}(),A=new t.InjectionToken("NgxEditorConfig"),P=function(){function e(){}var o;return o=e,e.forRoot=function(e){return{ngModule:o,providers:[{provide:A,useValue:e},{provide:T,useFactory:q,deps:[A]}]}},e=o=c([t.NgModule({declarations:[K],exports:[K]})],e)}();e.NgxEditorComponent=K,e.NgxEditorModule=P,e.isListItem=m,e.isMarkActive=l,e.isNodeActive=h,e.marks=V,e.menu=M,e.nodes=H,e.placeholder=I,e.schema=O,e.toggleBlockType=g,e.toggleList=f,e.toggleWrap=_,e.ɵ0=u,e.ɵa=T,e.ɵb=j,e.ɵc=q,Object.defineProperty(e,"__esModule",{value:!0})}));
//# sourceMappingURL=ngx-editor.umd.min.js.map